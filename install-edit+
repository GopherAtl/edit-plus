if not http then
  error("http api required.")
end

local branch="master"

local args={...}
if #args>0 then
  if #args==1 and args[1]=="beta" then
    branch="dev"
  else
    error("unknown arguments!")
  end
end

local path=shell.dir().."/"

function grabFile(name)
  write("downloading '"..name.."'...")

  local req=http.get("https://raw.githubusercontent.com/GopherAtl/edit-plus/"..branch.."/"..name)
  if req==nil then
    error("Cound't make request!")
  end

  if req.getResponseCode()~=200 then
    req.close()
    error("Unexpected response code "..req.getResponseCode())
  end

  local text=req.readAll()

  req.close()


  local file=fs.open(path..name,"w")
  if not file then
    error("Couldn't open file '"..name.."' for writing!")
  end

  file.write(text)
  file.close()
  print("success! "..#text.." bytes")
end

grabFile("edit+")
grabFile("hilight")
grabFile("guiutils")
grabFile("document
